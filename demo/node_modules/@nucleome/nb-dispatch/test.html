<!DOCTYPE html >
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Extension_test</title>
    <script src="./dist/nb-dispatch.js"></script>
</head>

<body>
    <div id="connection"></div>
    <button id="btn">Navigate to chr2:10001-50000 </button>
    <button id="btn2">Highlight chr2:15001-20000 </button>
    <button id="btn3">Deregister Highlight Event </button>
    <button id="btn4">Register Highlight Event </button>
    <div id="message"></div>
    <script>
        (function()
        {
            var chan = nb.dispatch("update", "brush")
            chan.connect(function(d)
            {
                document.getElementById("connection").innerHTML =
                    d.connection
            })
            var i = 0;
            var log = function(d)
            {
                i++;
                document.getElementById("message").innerHTML =
                    "event:"+i+"<div>"+JSON.stringify(d)+"</div>"
            }
            document.getElementById("btn").onclick = function(e)
            {
                chan.call("update", this, [
                {
                    chr: "chr2",
                    start: 10000,
                    end: 50000
                }])
            }
            document.getElementById("btn2").onclick = function(e)
            {
                chan.call("brush", this, [
                {
                    chr: "chr2",
                    start: 15000,
                    end: 20000
                }])
            }
            document.getElementById("btn3").onclick = function(e)
            {
                chan.on("brush.xyz", null)
            }
            document.getElementById("btn4").onclick = function(e)
            {
                chan.on("brush.xyz", log)
            }
            chan.on("update.app brush.xyz", log)
        })()
    </script>
</body>

</html>
